<!DOCTYPE html>
<html style="font-size:.2vh;">
	<head>
		<title>Hello world!</title>
        <style type="text/css">
            /* BEGIN Set these before anything else to show a flat black screen */
            body {
                width: 100%;
                height: 100%;
                background: #000000;
                display: block;
                position: fixed;
                font-size: 5%;
            }
            .gameScreen {
                background: #222222;
                height: 100%;
                width: 150vh;
                margin-left: -75vh;
                left: 50%;
                position: fixed;
            }
            .gameObject {
                display: block;
                position: absolute;
            }
            .awaitLoad {
                opacity: 0;
            }
            /* END Set these before anything else to show a flat black screen */

            /* BEGIN Loading screen */
            @keyframes rotate {
                0% { transform:rotate(0deg); }
                25% { transform:rotate(90deg); }
                50% { transform:rotate(180deg); }
                75% { transform:rotate(270deg); }
                100% { transform:rotate(360deg); }
            }
            .loadingScreen {
                width: 100%;
                height: 100%;
                background: #269abc;
            }
            .loadingScreen .spinner {
                animation-name: rotate;
                animation-duration: 3s;
                animation-play-state:running;
                color: #fff;
                animation-iteration-count: infinite;
                animation-timing-function: linear;
                left: 50%;
                top: 50%;
                margin-left: -2em;
                margin-top: -.5em;
                font-size: 4rem;
            }
            .loadingScreen.done {
                animation-name: fadeout;
                animation-duration: 1s;
                animation-timing-function: linear;
                animation-iteration-count: 1;
                animation-fill-mode: forwards;
            }
            /* END Loading screen */
        </style>
        <script id="script_load" type="text/javascript" src="./load.js"> </script>
        <script id="script_howler" type="text/javascript" src="./lib/howler.js-master/dist/howler.min.js"> </script>
        <script type="text/javascript">
            // Preload sounds
            gameManager.sounds.ambient = new Howl({
                src: './audio/ambient_space.mp3',
                autoplay: false,
                loop: true,
                volume: 0
            });
        </script>
        <script id="script_jquery" type="text/javascript" src="./lib/jquery-3.2.1.min.js"> </script>
        <!-- Discussions -->
        <script id="script_discussions" type="text/javascript" src="./discussions.js"></script>
        <script id="script_discussion_ebena" type="text/javascript" src="./discussions/ebena.js"></script>

        <link rel="stylesheet" href="reset.css" />
        <link rel="stylesheet" href="style.css" />
        <script type="text/javascript">
            gameManager.preLoader.addSemaphore('script_load',true);
            document.getElementById('script_load').addEventListener('onload',function(){
                console.log ('poop');
                gameManager.preLoader.removeSemaphore('script_load');
            });

            // Trigger preloader
            (function (){
                // Set it in half a second to allow things to pre-initialize
                window.setTimeout(function(){
                    window.gameManager.preLoader.initialize();
                },500);
            })();
        </script>
	</head>
	<body>
        <div class="gameScreen gameObject">
            <!-- playArea is the width of the screen, and contains all gameObjects. -->
            <div class="playArea gameObject">
                <!-- shipInterior is as wide as the ship, and scrolls back and forth -->
                <div class="shipInterior gameObject">
                    <div class="gameObject backWall">
                    </div>

                    <!-- JAIL CELLS -->
                    <div class="gameObject interactable clickable jailcell first ebena" discussionname="ebena" id="ebenaCell">
                    </div>
                    <div class="gameObject interactable clickable jailcell second">
                    </div>
                    <div class="gameObject interactable clickable jailcell third">
                    </div>
                    <div class="gameObject interactable clickable jailcell fourth">
                    </div>
                    <div class="gameObject interactable clickable jailcell fifth">
                    </div>

                    <!-- LOCKERS -->
                    <div class="gameObject interactable clickable locker communicator">
                    </div>
                    <div class="gameObject interactable clickable locker jacket">
                    </div>
                    <div class="gameObject interactable clickable locker dicks">
                    </div>
                    <div class="gameObject interactable clickable locker translator">
                    </div>

                    <!-- OBJECTS -->
                    <div class="gameObject interactable clickable bunk bed" worldtrigger="sleep">
                    </div>
                    <!--
                    <div class="gameObject interactable clickable bunk vault">
                    </div>
                    <div class="gameObject interactable clickable bunk coffee">
                    </div>
                    <div class="gameObject interactable clickable bunk transmitter">
                    </div>
                    -->

                    <!-- PLAYER -->
                    <div class="gameObject player">
                    </div>

                </div>
            </div>
            <!--
            <div class="gameObject bottomUI">
            </div>
            -->
            <div class="gameObject popupUI hidden">
                <div class="gameObject popupWindow">
                    <div class="gameObject portrait hugh neutral">
                        <div class="gameObject picture"> </div>
                        <div class="gameObject eminata"> </div>
                    </div>
                    <div class="gameObject conversationWindow">
                        <div class="gameObject statement">
                            Seriously I hate you so much!  How can you possibly think that this is OK!  What the EEFFFFFF!!!!! OMGOMGOMG!
                            Why do I even tolerate your assholery!
                        </div>
                        <div class="gameObject responses">
                            <div class="gameObject responseChoice clickable first">
                                Why u hate me y0?
                            </div>
                            <div class="gameObject responseChoice right clickable second">
                                Sorry!  Didn't mean to offend!
                            </div>
                            <div class="gameObject responseChoice bottom clickable third">
                                Maybe you're just oversensitive!!!
                            </div>
                            <div class="gameObject responseChoice bottom right clickable fourth">
                                ...
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="gameObject loadingScreen">
            <div class="gameObject spinner">
                Loading...
            </div>
        </div>
        <script type="text/javascript">
            // Fade out preLoader, and initialize everything else
            gameManager.setEvent(gameManager.eventNames.loadingScreenComplete, function() {
                var element = document.getElementsByClassName('loadingScreen')[0];
                element.className += " done";
                element.addEventListener('animationend', function(e,f){
                    console.log('foobar:',e);
                    e.target.className += " displayNone";
                }, false);
            });

            // Fade in sound
            gameManager.setEvent(gameManager.eventNames.loadingScreenComplete, function() {
                gameManager.sounds.ambient.play();
                gameManager.sounds.ambient.fade(0,1,1000);
            });

            // Prepare navigables
            gameManager.setEvent(gameManager.eventNames.gameLoaded, function() {
                $('.gameObject.interactable').click(function(e,f){

                });
            });
        </script>
	</body>
</html>